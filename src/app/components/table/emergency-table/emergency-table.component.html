<div class="max-h-[410px] 3xl:max-h-[620px] overflow-y-auto">
    <table class="w-full">
        <thead class="bg-[#e8eef8] sticky top-0 z-[1]">
            <tr>
                <th class="text-paragraph tracking-wide font-medium py-5 px-5 text-sm text-left">Emergency type</th>
                <th class="text-paragraph tracking-wide font-medium py-5 px-5 text-sm text-left">Date created</th>
                <th class="text-paragraph tracking-wide font-medium py-5 px-5 text-sm text-left">Profession</th>
                <th class="text-paragraph tracking-wide font-medium py-5 px-5 text-sm text-left">Status</th>
                <th class="text-paragraph tracking-wide font-medium py-5 px-5 text-sm text-left">Action</th>
            </tr>
        </thead>
        <tbody>
            <tr class="text-sm text-paragraph tracking-wide" *ngFor="let emergency of emergencies; let i = index">
                <td class="px-5">
                    <p class="text-paragraph text-sm">{{ emergency.emergencyType }}</p>
                </td>
                <td class="px-5 text-paragraph text-sm">{{emergency.date}}</td>
                <td class="px-5 text-paragraph text-sm">
                    <ng-container>
                        <span 
                            class="bg-gray-100 py-[4px] px-[10px] rounded-full font-medium mr-[10px]" 
                            *ngFor="let prof of asArray(emergency.profession).slice(0, 2)"
                        >
                            {{ prof }}
                        </span>
                        <span 
                            *ngIf="showMoreThanTwo(asArray(emergency.profession))"
                            class="bg-border text-heading text-xs py-[5px] px-[10px] rounded-full font-semibold cursor-pointer"
                            (click)="toggleProfessionsDropdown(i)"
                        >
                            +{{ asArray(emergency.profession).length - 2 }}
                        </span>
                        <div *ngIf="isProfessionsDropdownVisible[i]" class="relative inline-block">
                            <div class="absolute w-[222px] right-3 bg-white border border-border shadow-lg z-10 mt-5">
                                <ng-container *ngFor="let prof of asArray(emergency.profession).slice(2)">
                                    <div 
                                        class="flex items-center justify-between w-full px-4 py-2 cursor-pointer"
                                    >
                                        <p class="text-paragraph tracking-wide">{{ prof }}</p>
                                        <span class="flex items-center gap-[10px]">
                                            <img src="../../../../assets/edit.svg" class="cursor-pointer" alt="edit">
                                            <img src="../../../../assets/trash-2.svg" class="cursor-pointer" alt="trash">
                                        </span>
                                    </div>
                                </ng-container>
                                <span 
                                    class="block py-2 px-4 text-blue-500 cursor-pointer hover:bg-[#EAECF0]"
                                    (click)="toggleProfessionsDropdown(i)"
                                >
                                    Show Less
                                </span>
                            </div>
                        </div>
                    </ng-container>
                </td>
                <td class="px-5 text-paragraph text-sm">
                    <span 
                        [ngClass]="{
                            'bg-suspendBg text-suspend': emergency.status === 'active',
                            'bg-secondary text-primary': emergency.status === 'completed',
                        }"
                        class="px-[14px] py-[4px] text-xs rounded-full font-bold"
                    >
                        {{emergency.status}}
                    </span>
                </td>
                <td class="py-4 px-5 text-paragraph relative">
                    <img 
                        src="../../../assets/action.svg" 
                        class="cursor-pointer" 
                        alt="action-icon"
                        (click)="toggleDropdown(i)"
                    />
                    <div 
                        *ngIf="isDropdownVisible[i]" 
                        class="absolute right-6 2xl:right-20 mt-1 w-[222px] bg-white border border-border shadow-lg z-10"
                    >
                        <button 
                            (click)="OpenEditEmergency()"
                            class="flex items-center gap-[12px] w-full px-4 py-2 hover:bg-[#EAECF0]"
                        >
                            <img src="../../../../assets/edit.svg" alt="edit">
                            <p class="text-heading text-left tracking-wide">Edit emergency</p>
                        </button>
                        <button 
                            (click)="closeEditEmergencyModal()" 
                            class="flex items-center gap-[12px] w-full px-4 py-2 hover:bg-[#EAECF0]"
                        >
                            <img src="../../../../assets/trash.svg" alt="trash">
                            <p class="text-heading text-left tracking-wide">Delete emergency</p>
                        </button>
                    </div>
                </td>
            </tr>                        
        </tbody>
    </table>

    <app-edit-emergency-modal 
        *ngIf="isEditModalOpen"
        (cancel)="closeEditEmergencyModal()"
        (submit)="onEditEmergencySubmit()"
    />
</div>